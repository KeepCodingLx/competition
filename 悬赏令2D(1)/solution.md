# 最大值计数

## Solution

本题目来自百度之星2022年复赛。

### 子任务1：暴力

每个位置从$1$到$m$循环，然后扫描一遍统计最大值个数，时间复杂度$O(m^{n+1})$;

### 子任务2：枚举最大值出现次数

我们并不需要真的把每个数列都表示出来，而是通过枚举MC值（即最大值出现次数）来解决这一问题。
1. 当最大值为$1$时，显然只有$1$种情况，其MC值为$n$；
2. 当最大值为$i(i>1)$时，MC值为$j$时，这样的数列有$(i-1)^{n-j}·C_n^j$个；

因此答案为$$n+\sum_{i=2}^{m}\sum_{j=1}^{n}j(i-1)^{n-j}C_n^j$$

$O(n^2)$预处理组合数，$O(mn)$计算上述组合式。

### 子任务3：一些组合数变形技巧

借助二项式定理，经过一些代数恒等变形，我们可以发现，上式等于
$$n\sum_{i=1}^m i^{n-1}$$

时间复杂度$O(m\log n)$。

### 子任务4：Bernoulli级数

如果你知道Bernoulli级数的话，你大约也会知道上面这个式子在$m$较大的时候还有一种$O(n^2)$的算法，可以参见[这一篇文章](https://blog.csdn.net/mango114514/article/details/122747668)。

这里还有另一道类似的题目供你练习这个知识点：https://www.luogu.com.cn/problem/P6271


### 子任务5：Lagrange插值法

给定$n+1$个坐标不同的点。Lagrange插值法可以在$O(n^2)$的时间内给出一个恰好经过这$n+1$个点的多项式函数。

另外，在点的坐标有规律时，可以优化到$O(n)$，比如本题。

Lagrange插值法介绍：https://blog.csdn.net/weixin_44178736/article/details/104190863

Lagrange插值法求等幂和：https://blog.csdn.net/jokerwyt/article/details/78165667

完成子任务5需要分段：

1. 对于$n\le 2\times 10^7$，采用Lagrange插值法；
2. 对于$m\le 5\times 10^6$，采用子任务3的方法；
